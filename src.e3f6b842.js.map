{"version":3,"sources":["../node_modules/events/events.js","../node_modules/reconnecting-websocket/dist/reconnecting-websocket-mjs.js","index.js"],"names":["ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ProcessEmitWarning","warning","console","warn","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","module","exports","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","m","events","existing","create","newListener","emit","unshift","push","length","warned","w","Error","String","name","emitter","count","onceWrapper","fired","arguments","removeListener","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","unwrapListeners","arrayClone","listenerCount","arr","n","copy","Array","i","spliceOne","list","index","pop","ret","defineProperty","enumerable","get","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","len","listeners","addListener","on","prependListener","once","prependOnceListener","position","originalListener","shift","off","removeAllListeners","keys","key","rawListeners","eventNames","ReconnectingWebSocket","extendStatics","d","b","setPrototypeOf","__proto__","p","hasOwnProperty","__extends","__","constructor","__values","o","Symbol","iterator","next","done","__read","r","e","ar","__spread","Event","ErrorEvent","_super","_this","CloseEvent","code","reason","wasClean","getGlobalWebSocket","WebSocket","isWebSocket","CLOSING","DEFAULT","maxReconnectionDelay","minReconnectionDelay","Math","random","minUptime","reconnectionDelayGrowFactor","connectionTimeout","maxRetries","Infinity","maxEnqueuedMessages","startClosed","debug","url","protocols","options","open","close","_retryCount","_shouldReconnect","_connectLock","_binaryType","_closeCalled","_messageQueue","onclose","onerror","onmessage","onopen","_handleOpen","event","_debug","_a","_options","clearTimeout","_connectTimeout","_uptimeTimeout","setTimeout","_acceptOpen","_ws","binaryType","forEach","send","_callEventListener","_handleMessage","_handleError","_disconnect","_connect","_handleClose","_clearTimeouts","_url","_protocols","configurable","CONNECTING","OPEN","CLOSED","max","bytes","reduce","acc","Blob","size","byteLength","bufferedAmount","extensions","protocol","readyState","reconnect","data","addEventListener","dispatchEvent","e_1","listeners_1","listeners_1_1","e_1_1","return","removeEventListener","filter","l","_i","log","_getNextDelay","_b","_c","_d","delay","pow","_wait","Promise","resolve","_getNextUrl","urlProvider","then","_removeListeners","_addListeners","_handleTimeout","handleEvent","createPeer","localVideoElement","remoteVideoElement","signalingChannel","localCallId","peer","RTCPeerConnection","iceServers","urls","constraints","video","subscribe","toId","fromId","desc","candidate","setRemoteDescription","navigator","mediaDevices","getUserMedia","stream","getTracks","track","addTrack","createAnswer","answer","setLocalDescription","localDescription","addIceCandidate","onicecandidate","ontrack","srcObject","streams","remoteCallId","createOffer","offer","wsSignalingChannel","socket","msg","JSON","parse","cb","stringify","ownId","window","location","search","video1","document","getElementById","video2","form","preventDefault","elements"],"mappings":";AAqBA,aAEA,IAOIA,EAPAC,EAAuB,iBAAZC,QAAuBA,QAAU,KAC5CC,EAAeF,GAAwB,mBAAZA,EAAEG,MAC7BH,EAAEG,MACF,SAAsBC,EAAQC,EAAUC,GACjCC,OAAAA,SAASC,UAAUL,MAAMM,KAAKL,EAAQC,EAAUC,IAiB3D,SAASI,EAAmBC,GACtBC,SAAWA,QAAQC,MAAMD,QAAQC,KAAKF,GAb1CZ,EADEC,GAA0B,mBAAdA,EAAEc,QACCd,EAAEc,QACVC,OAAOC,sBACC,SAAwBZ,GAChCW,OAAAA,OAAOE,oBAAoBb,GAC/Bc,OAAOH,OAAOC,sBAAsBZ,KAGxB,SAAwBA,GAChCW,OAAAA,OAAOE,oBAAoBb,IAQtC,IAAIe,EAAcC,OAAOC,OAAS,SAAqBC,GAC9CA,OAAAA,GAAUA,GAGnB,SAASC,IACPA,EAAaC,KAAKf,KAAK,MAEzBgB,OAAOC,QAAUH,EAGjBA,EAAaA,aAAeA,EAE5BA,EAAaf,UAAUmB,aAAUC,EACjCL,EAAaf,UAAUqB,aAAe,EACtCN,EAAaf,UAAUsB,mBAAgBF,EAIvC,IAAIG,EAAsB,GAE1B,SAASC,EAAcC,GACjB,GAAoB,mBAAbA,EACH,MAAA,IAAIC,UAAU,0EAA4ED,GAsCpG,SAASE,EAAiBC,GACpBA,YAAuBR,IAAvBQ,EAAKN,cACAP,EAAaQ,oBACfK,EAAKN,cAmDd,SAASO,EAAajC,EAAQkC,EAAML,EAAUM,GACxCC,IAAAA,EACAC,EACAC,EAsBAA,GApBJV,EAAcC,QAGCL,KADfa,EAASrC,EAAOuB,UAEdc,EAASrC,EAAOuB,QAAUZ,OAAO4B,OAAO,MACxCvC,EAAOyB,aAAe,SAIKD,IAAvBa,EAAOG,cACTxC,EAAOyC,KAAK,cAAeP,EACfL,EAASA,SAAWA,EAASA,SAAWA,GAIpDQ,EAASrC,EAAOuB,SAElBe,EAAWD,EAAOH,SAGHV,IAAbc,EAEFA,EAAWD,EAAOH,GAAQL,IACxB7B,EAAOyB,kBAeLW,GAboB,mBAAbE,EAETA,EAAWD,EAAOH,GAChBC,EAAU,CAACN,EAAUS,GAAY,CAACA,EAAUT,GAErCM,EACTG,EAASI,QAAQb,GAEjBS,EAASK,KAAKd,IAIhBO,EAAIL,EAAiB/B,IACb,GAAKsC,EAASM,OAASR,IAAME,EAASO,OAAQ,CACpDP,EAASO,QAAS,EAGdC,IAAAA,EAAI,IAAIC,MAAM,+CACET,EAASM,OAAS,IAAMI,OAAOd,GAAQ,qEAG3DY,EAAEG,KAAO,8BACTH,EAAEI,QAAUlD,EACZ8C,EAAEZ,KAAOA,EACTY,EAAEK,MAAQb,EAASM,OACnBtC,EAAmBwC,GAIhB9C,OAAAA,EAcT,SAASoD,IACH,IAAC,KAAKC,MAGJC,OAFCtD,KAAAA,OAAOuD,eAAe,KAAKrB,KAAM,KAAKsB,QACtCH,KAAAA,OAAQ,EACY,IAArBC,UAAUV,OACL,KAAKf,SAASxB,KAAK,KAAKL,QAC1B,KAAK6B,SAAS9B,MAAM,KAAKC,OAAQsD,WAI5C,SAASG,EAAUzD,EAAQkC,EAAML,GAC3B6B,IAAAA,EAAQ,CAAEL,OAAO,EAAOG,YAAQhC,EAAWxB,OAAQA,EAAQkC,KAAMA,EAAML,SAAUA,GACjF8B,EAAUP,EAAYQ,KAAKF,GAGxBC,OAFPA,EAAQ9B,SAAWA,EACnB6B,EAAMF,OAASG,EACRA,EA0HT,SAASE,EAAW7D,EAAQkC,EAAM4B,GAC5BzB,IAAAA,EAASrC,EAAOuB,QAEhBc,QAAWb,IAAXa,EACF,MAAO,GAEL0B,IAAAA,EAAa1B,EAAOH,GACpB6B,YAAevC,IAAfuC,EACK,GAEiB,mBAAfA,EACFD,EAAS,CAACC,EAAWlC,UAAYkC,GAAc,CAACA,GAElDD,EACLE,EAAgBD,GAAcE,EAAWF,EAAYA,EAAWnB,QAoBpE,SAASsB,EAAchC,GACjBG,IAAAA,EAAS,KAAKd,QAEdc,QAAWb,IAAXa,EAAsB,CACpB0B,IAAAA,EAAa1B,EAAOH,GAEpB,GAAsB,mBAAf6B,EACF,OAAA,EACF,QAAmBvC,IAAfuC,EACFA,OAAAA,EAAWnB,OAIf,OAAA,EAOT,SAASqB,EAAWE,EAAKC,GAElB,IADDC,IAAAA,EAAO,IAAIC,MAAMF,GACZG,EAAI,EAAGA,EAAIH,IAAKG,EACvBF,EAAKE,GAAKJ,EAAII,GACTF,OAAAA,EAGT,SAASG,EAAUC,EAAMC,GAChBA,KAAAA,EAAQ,EAAID,EAAK7B,OAAQ8B,IAC9BD,EAAKC,GAASD,EAAKC,EAAQ,GAC7BD,EAAKE,MAGP,SAASX,EAAgBG,GAElB,IADDS,IAAAA,EAAM,IAAIN,MAAMH,EAAIvB,QACf2B,EAAI,EAAGA,EAAIK,EAAIhC,SAAU2B,EAChCK,EAAIL,GAAKJ,EAAII,GAAG1C,UAAYsC,EAAII,GAE3BK,OAAAA,EAlXTjE,OAAOkE,eAAe1D,EAAc,sBAAuB,CACzD2D,YAAY,EACZC,IAAK,WACIpD,OAAAA,GAETqD,IAAK,SAASC,GACR,GAAe,iBAARA,GAAoBA,EAAM,GAAKlE,EAAYkE,GAC9C,MAAA,IAAIC,WAAW,kGAAoGD,EAAM,KAEjItD,EAAsBsD,KAI1B9D,EAAaC,KAAO,gBAEGI,IAAjB,KAAKD,SACL,KAAKA,UAAYZ,OAAOwE,eAAe,MAAM5D,UAC1CA,KAAAA,QAAUZ,OAAO4B,OAAO,MACxBd,KAAAA,aAAe,GAGjBC,KAAAA,cAAgB,KAAKA,oBAAiBF,GAK7CL,EAAaf,UAAUgF,gBAAkB,SAAyBhB,GAC5D,GAAa,iBAANA,GAAkBA,EAAI,GAAKrD,EAAYqD,GAC1C,MAAA,IAAIc,WAAW,gFAAkFd,EAAI,KAGtG,OADF1C,KAAAA,cAAgB0C,EACd,MASTjD,EAAaf,UAAUiF,gBAAkB,WAChCtD,OAAAA,EAAiB,OAG1BZ,EAAaf,UAAUqC,KAAO,SAAcP,GAErC,IADDhC,IAAAA,EAAO,GACFqE,EAAI,EAAGA,EAAIjB,UAAUV,OAAQ2B,IAAKrE,EAAKyC,KAAKW,UAAUiB,IAC3De,IAAAA,EAAoB,UAATpD,EAEXG,EAAS,KAAKd,QACdc,QAAWb,IAAXa,EACFiD,EAAWA,QAA4B9D,IAAjBa,EAAOkD,WAC1B,IAAKD,EACR,OAAO,EAGLA,GAAAA,EAAS,CACPE,IAAAA,EAGAA,GAFAtF,EAAK0C,OAAS,IAChB4C,EAAKtF,EAAK,IACRsF,aAAczC,MAGVyC,MAAAA,EAGJC,IAAAA,EAAM,IAAI1C,MAAM,oBAAsByC,EAAK,KAAOA,EAAGE,QAAU,IAAM,KAEnED,MADNA,EAAIE,QAAUH,EACRC,EAGJG,IAAAA,EAAUvD,EAAOH,GAEjB0D,QAAYpE,IAAZoE,EACF,OAAO,EAEL,GAAmB,mBAAZA,EACT9F,EAAa8F,EAAS,KAAM1F,OAExB2F,CAAAA,IAAAA,EAAMD,EAAQhD,OACdkD,EAAY7B,EAAW2B,EAASC,GAC/B,IAAItB,EAAI,EAAGA,EAAIsB,IAAOtB,EACzBzE,EAAagG,EAAUvB,GAAI,KAAMrE,GAG9B,OAAA,GAiETiB,EAAaf,UAAU2F,YAAc,SAAqB7D,EAAML,GACvDI,OAAAA,EAAa,KAAMC,EAAML,GAAU,IAG5CV,EAAaf,UAAU4F,GAAK7E,EAAaf,UAAU2F,YAEnD5E,EAAaf,UAAU6F,gBACnB,SAAyB/D,EAAML,GACtBI,OAAAA,EAAa,KAAMC,EAAML,GAAU,IAqBhDV,EAAaf,UAAU8F,KAAO,SAAchE,EAAML,GAGzC,OAFPD,EAAcC,GACTmE,KAAAA,GAAG9D,EAAMuB,EAAU,KAAMvB,EAAML,IAC7B,MAGTV,EAAaf,UAAU+F,oBACnB,SAA6BjE,EAAML,GAG1B,OAFPD,EAAcC,GACToE,KAAAA,gBAAgB/D,EAAMuB,EAAU,KAAMvB,EAAML,IAC1C,MAIbV,EAAaf,UAAUmD,eACnB,SAAwBrB,EAAML,GACxB4C,IAAAA,EAAMpC,EAAQ+D,EAAU7B,EAAG8B,EAK3BhE,GAHJT,EAAcC,QAGCL,KADfa,EAAS,KAAKd,SAEZ,OAAO,KAGLkD,QAASjD,KADbiD,EAAOpC,EAAOH,IAEZ,OAAO,KAELuC,GAAAA,IAAS5C,GAAY4C,EAAK5C,WAAaA,EACb,KAAtB,KAAKJ,aACT,KAAKF,QAAUZ,OAAO4B,OAAO,cAEtBF,EAAOH,GACVG,EAAOkB,gBACT,KAAKd,KAAK,iBAAkBP,EAAMuC,EAAK5C,UAAYA,SAElD,GAAoB,mBAAT4C,EAAqB,CAGhCF,IAFL6B,GAAY,EAEP7B,EAAIE,EAAK7B,OAAS,EAAG2B,GAAK,EAAGA,IAC5BE,GAAAA,EAAKF,KAAO1C,GAAY4C,EAAKF,GAAG1C,WAAaA,EAAU,CACzDwE,EAAmB5B,EAAKF,GAAG1C,SAC3BuE,EAAW7B,EACX,MAIA6B,GAAAA,EAAW,EACb,OAAO,KAEQ,IAAbA,EACF3B,EAAK6B,QAEL9B,EAAUC,EAAM2B,GAGE,IAAhB3B,EAAK7B,SACPP,EAAOH,GAAQuC,EAAK,SAEQjD,IAA1Ba,EAAOkB,gBACT,KAAKd,KAAK,iBAAkBP,EAAMmE,GAAoBxE,GAGnD,OAAA,MAGbV,EAAaf,UAAUmG,IAAMpF,EAAaf,UAAUmD,eAEpDpC,EAAaf,UAAUoG,mBACnB,SAA4BtE,GACtB4D,IAAAA,EAAWzD,EAAQkC,EAGnBlC,QAAWb,KADfa,EAAS,KAAKd,SAEZ,OAAO,KAGLc,QAA0Bb,IAA1Ba,EAAOkB,eAUF,OATkB,IAArBD,UAAUV,QACPrB,KAAAA,QAAUZ,OAAO4B,OAAO,MACxBd,KAAAA,aAAe,QACMD,IAAjBa,EAAOH,KACY,KAAtB,KAAKT,aACT,KAAKF,QAAUZ,OAAO4B,OAAO,aAEtBF,EAAOH,IAEX,KAILoB,GAAqB,IAArBA,UAAUV,OAAc,CACtB6D,IACAC,EADAD,EAAO9F,OAAO8F,KAAKpE,GAElBkC,IAAAA,EAAI,EAAGA,EAAIkC,EAAK7D,SAAU2B,EAEjB,oBADZmC,EAAMD,EAAKlC,KAENiC,KAAAA,mBAAmBE,GAKnB,OAHFF,KAAAA,mBAAmB,kBACnBjF,KAAAA,QAAUZ,OAAO4B,OAAO,MACxBd,KAAAA,aAAe,EACb,KAKL,GAAqB,mBAFzBqE,EAAYzD,EAAOH,IAGZqB,KAAAA,eAAerB,EAAM4D,QACrB,QAAkBtE,IAAdsE,EAEJvB,IAAAA,EAAIuB,EAAUlD,OAAS,EAAG2B,GAAK,EAAGA,IAChChB,KAAAA,eAAerB,EAAM4D,EAAUvB,IAIjC,OAAA,MAoBbpD,EAAaf,UAAU0F,UAAY,SAAmB5D,GAC7C2B,OAAAA,EAAW,KAAM3B,GAAM,IAGhCf,EAAaf,UAAUuG,aAAe,SAAsBzE,GACnD2B,OAAAA,EAAW,KAAM3B,GAAM,IAGhCf,EAAa+C,cAAgB,SAAShB,EAAShB,GACzC,MAAiC,mBAA1BgB,EAAQgB,cACVhB,EAAQgB,cAAchC,GAEtBgC,EAAc7D,KAAK6C,EAAShB,IAIvCf,EAAaf,UAAU8D,cAAgBA,EAiBvC/C,EAAaf,UAAUwG,WAAa,WAC3B,OAAA,KAAKnF,aAAe,EAAI9B,EAAe,KAAK4B,SAAW;;ACmKjDsF,aAAAA,OAAAA,eAAAA,QAAAA,aAAAA,CAAAA,OAAAA,IAAAA,QAAAA,aAAAA,EA1jBf,IAAIC,EAAgB,SAASC,EAAGC,GAIrBF,OAHPA,EAAgBnG,OAAOsG,gBAClB,CAAEC,UAAW,cAAgB5C,OAAS,SAAUyC,EAAGC,GAAKD,EAAEG,UAAYF,IACvE,SAAUD,EAAGC,GAAU,IAAA,IAAIG,KAAKH,EAAOA,EAAEI,eAAeD,KAAIJ,EAAEI,GAAKH,EAAEG,MACpDJ,EAAGC,IAG5B,SAASK,EAAUN,EAAGC,GAETM,SAAAA,IAAYC,KAAAA,YAAcR,EADnCD,EAAcC,EAAGC,GAEjBD,EAAE3G,UAAkB,OAAN4G,EAAarG,OAAO4B,OAAOyE,IAAMM,EAAGlH,UAAY4G,EAAE5G,UAAW,IAAIkH,GAGnF,SAASE,EAASC,GACVrF,IAAAA,EAAsB,mBAAXsF,QAAyBD,EAAEC,OAAOC,UAAWpD,EAAI,EAC5DnC,OAAAA,EAAUA,EAAE/B,KAAKoH,GACd,CACHG,KAAM,WAEK,OADHH,GAAKlD,GAAKkD,EAAE7E,SAAQ6E,OAAI,GACrB,CAAEvG,MAAOuG,GAAKA,EAAElD,KAAMsD,MAAOJ,KAKhD,SAASK,EAAOL,EAAGrD,GACXhC,IAAAA,EAAsB,mBAAXsF,QAAyBD,EAAEC,OAAOC,UAC7C,IAACvF,EAAG,OAAOqF,EACXlD,IAAewD,EAAYC,EAA3BzD,EAAInC,EAAE/B,KAAKoH,GAAOQ,EAAK,GACvB,IACO,WAAO,IAAN7D,GAAgBA,KAAM,MAAQ2D,EAAIxD,EAAEqD,QAAQC,MAAMI,EAAGtF,KAAKoF,EAAE7G,OAExE,MAAOqE,GAASyC,EAAI,CAAEzC,MAAOA,GACrB,QACA,IACIwC,IAAMA,EAAEF,OAASzF,EAAImC,EAAC,SAAanC,EAAE/B,KAAKkE,GAE1C,QAAMyD,GAAAA,EAAG,MAAMA,EAAEzC,OAEtB0C,OAAAA,EAGX,SAASC,IACA,IAAA,IAAID,EAAK,GAAI1D,EAAI,EAAGA,EAAIjB,UAAUV,OAAQ2B,IAC3C0D,EAAKA,EAAGnH,OAAOgH,EAAOxE,UAAUiB,KAC7B0D,OAAAA,EAGX,IAAIE,EAAuB,WAKhBA,OAJEA,SAAMjG,EAAMlC,GACZA,KAAAA,OAASA,EACTkC,KAAAA,KAAOA,GAHO,GAOvBkG,EAA4B,SAAUC,GAE7BD,SAAAA,EAAW7C,EAAOvF,GACnBsI,IAAAA,EAAQD,EAAOhI,KAAK,KAAM,QAASL,IAAW,KAG3CsI,OAFPA,EAAM5C,QAAUH,EAAMG,QACtB4C,EAAM/C,MAAQA,EACP+C,EAEJF,OAPPf,EAAUe,EAAYC,GAOfD,EARqB,CAS9BD,GACEI,EAA4B,SAAUF,GAE7BE,SAAAA,EAAWC,EAAMC,EAAQzI,QACjB,IAATwI,IAAmBA,EAAO,UACf,IAAXC,IAAqBA,EAAS,IAC9BH,IAAAA,EAAQD,EAAOhI,KAAK,KAAM,QAASL,IAAW,KAI3CsI,OAHPA,EAAMI,UAAW,EACjBJ,EAAME,KAAOA,EACbF,EAAMG,OAASA,EACRH,EAEJC,OAVPlB,EAAUkB,EAAYF,GAUfE,EAXqB,CAY9BJ,GAQEQ,EAAqB,WACjB,GAAqB,oBAAdC,UAEAA,OAAAA,WAMXC,EAAc,SAAU/F,GAAY,YAAa,IAANA,KAAuBA,GAAmB,IAAdA,EAAEgG,SACzEC,EAAU,CACVC,qBAAsB,IACtBC,qBAAsB,IAAuB,IAAhBC,KAAKC,SAClCC,UAAW,IACXC,4BAA6B,IAC7BC,kBAAmB,IACnBC,WAAYC,EAAAA,EACZC,oBAAqBD,EAAAA,EACrBE,aAAa,EACbC,OAAO,GAEP9C,EAAuC,WAC9BA,SAAAA,EAAsB+C,EAAKC,EAAWC,GACvCxB,IAAAA,EAAQ,UACI,IAAZwB,IAAsBA,EAAU,IAC/BjG,KAAAA,WAAa,CACd0B,MAAO,GACPG,QAAS,GACTqE,KAAM,GACNC,MAAO,IAENC,KAAAA,aAAe,EACfC,KAAAA,kBAAmB,EACnBC,KAAAA,cAAe,EACfC,KAAAA,YAAc,OACdC,KAAAA,cAAe,EACfC,KAAAA,cAAgB,GAIhBC,KAAAA,QAAU,KAIVC,KAAAA,QAAU,KAIVC,KAAAA,UAAY,KAKZC,KAAAA,OAAS,KACTC,KAAAA,YAAc,SAAUC,GACzBtC,EAAMuC,OAAO,cACTC,IAAAA,EAAKxC,EAAMyC,SAAS3B,UAAWA,OAAmB,IAAP0B,EAAgB/B,EAAQK,UAAY0B,EACnFE,aAAa1C,EAAM2C,iBACnB3C,EAAM4C,eAAiBC,WAAW,WAAqB7C,OAAAA,EAAM8C,eAAkBhC,GAC/Ed,EAAM+C,IAAIC,WAAahD,EAAM8B,YAE7B9B,EAAMgC,cAAciB,QAAQ,SAAU7F,GAAkB4C,OAAAA,EAAM+C,IAAIG,KAAK9F,KACvE4C,EAAMgC,cAAgB,GAClBhC,EAAMoC,QACNpC,EAAMoC,OAAOE,GAEjBtC,EAAMzE,WAAWkG,KAAKwB,QAAQ,SAAU1J,GAAmByG,OAAAA,EAAMmD,mBAAmBb,EAAO/I,MAE1F6J,KAAAA,eAAiB,SAAUd,GAC5BtC,EAAMuC,OAAO,iBACTvC,EAAMmC,WACNnC,EAAMmC,UAAUG,GAEpBtC,EAAMzE,WAAW6B,QAAQ6F,QAAQ,SAAU1J,GAAmByG,OAAAA,EAAMmD,mBAAmBb,EAAO/I,MAE7F8J,KAAAA,aAAe,SAAUf,GAC1BtC,EAAMuC,OAAO,cAAeD,EAAMlF,SAClC4C,EAAMsD,iBAAYpK,EAA6B,YAAlBoJ,EAAMlF,QAAwB,eAAYlE,GACnE8G,EAAMkC,SACNlC,EAAMkC,QAAQI,GAElBtC,EAAMuC,OAAO,wBACbvC,EAAMzE,WAAW0B,MAAMgG,QAAQ,SAAU1J,GAAmByG,OAAAA,EAAMmD,mBAAmBb,EAAO/I,KAC5FyG,EAAMuD,YAELC,KAAAA,aAAe,SAAUlB,GAC1BtC,EAAMuC,OAAO,eACbvC,EAAMyD,iBACFzD,EAAM4B,kBACN5B,EAAMuD,WAENvD,EAAMiC,SACNjC,EAAMiC,QAAQK,GAElBtC,EAAMzE,WAAWmG,MAAMuB,QAAQ,SAAU1J,GAAmByG,OAAAA,EAAMmD,mBAAmBb,EAAO/I,MAE3FmK,KAAAA,KAAOpC,EACPqC,KAAAA,WAAapC,EACbkB,KAAAA,SAAWjB,EACZ,KAAKiB,SAASrB,cACTQ,KAAAA,kBAAmB,GAEvB2B,KAAAA,WA6XFhF,OA3XPlG,OAAOkE,eAAegC,EAAuB,aAAc,CACvD9B,IAAK,WACM,OAAA,GAEXD,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAuB,OAAQ,CACjD9B,IAAK,WACM,OAAA,GAEXD,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAuB,UAAW,CACpD9B,IAAK,WACM,OAAA,GAEXD,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAuB,SAAU,CACnD9B,IAAK,WACM,OAAA,GAEXD,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,aAAc,CACjE2E,IAAK,WACM8B,OAAAA,EAAsBsF,YAEjCrH,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,OAAQ,CAC3D2E,IAAK,WACM8B,OAAAA,EAAsBuF,MAEjCtH,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,UAAW,CAC9D2E,IAAK,WACM8B,OAAAA,EAAsBiC,SAEjChE,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,SAAU,CAC7D2E,IAAK,WACM8B,OAAAA,EAAsBwF,QAEjCvH,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,aAAc,CACjE2E,IAAK,WACM,OAAA,KAAKsG,IAAM,KAAKA,IAAIC,WAAa,KAAKlB,aAEjDpF,IAAK,SAAU9D,GACNkJ,KAAAA,YAAclJ,EACf,KAAKmK,MACAA,KAAAA,IAAIC,WAAapK,IAG9B4D,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,aAAc,CAIjE2E,IAAK,WACMmE,OAAAA,KAAKoD,IAAI,KAAKrC,YAAa,IAEtCnF,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,iBAAkB,CAOrE2E,IAAK,WAaMwH,OAZK,KAAKjC,cAAckC,OAAO,SAAUC,EAAK/G,GAU1C+G,MATgB,iBAAZ/G,EACP+G,GAAO/G,EAAQ9C,OAEV8C,aAAmBgH,KACxBD,GAAO/G,EAAQiH,KAGfF,GAAO/G,EAAQkH,WAEZH,GACR,IACa,KAAKpB,IAAM,KAAKA,IAAIwB,eAAiB,IAEzD/H,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,aAAc,CAKjE2E,IAAK,WACM,OAAA,KAAKsG,IAAM,KAAKA,IAAIyB,WAAa,IAE5ChI,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,WAAY,CAM/D2E,IAAK,WACM,OAAA,KAAKsG,IAAM,KAAKA,IAAI0B,SAAW,IAE1CjI,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,aAAc,CAIjE2E,IAAK,WACG,OAAA,KAAKsG,IACE,KAAKA,IAAI2B,WAEb,KAAKjC,SAASrB,YACf7C,EAAsBwF,OACtBxF,EAAsBsF,YAEhCrH,YAAY,EACZoH,cAAc,IAElBvL,OAAOkE,eAAegC,EAAsBzG,UAAW,MAAO,CAI1D2E,IAAK,WACM,OAAA,KAAKsG,IAAM,KAAKA,IAAIzB,IAAM,IAErC9E,YAAY,EACZoH,cAAc,IAMlBrF,EAAsBzG,UAAU4J,MAAQ,SAAUxB,EAAMC,QACvC,IAATD,IAAmBA,EAAO,KACzB6B,KAAAA,cAAe,EACfH,KAAAA,kBAAmB,EACnB6B,KAAAA,iBACA,KAAKV,IAIN,KAAKA,IAAI2B,aAAe,KAAKX,OAI5BhB,KAAAA,IAAIrB,MAAMxB,EAAMC,GAHZoC,KAAAA,OAAO,yBAJPA,KAAAA,OAAO,mCAapBhE,EAAsBzG,UAAU6M,UAAY,SAAUzE,EAAMC,GACnDyB,KAAAA,kBAAmB,EACnBG,KAAAA,cAAe,EACfJ,KAAAA,aAAe,EACf,KAAKoB,KAAO,KAAKA,IAAI2B,aAAe,KAAKX,QAIrCT,KAAAA,YAAYpD,EAAMC,GAClBoD,KAAAA,YAJAA,KAAAA,YAUbhF,EAAsBzG,UAAUoL,KAAO,SAAU0B,GACzC,GAAA,KAAK7B,KAAO,KAAKA,IAAI2B,aAAe,KAAKZ,KACpCvB,KAAAA,OAAO,OAAQqC,GACf7B,KAAAA,IAAIG,KAAK0B,OAEb,CACGpC,IAAAA,EAAK,KAAKC,SAAStB,oBAAqBA,OAA6B,IAAPqB,EAAgB/B,EAAQU,oBAAsBqB,EAC5G,KAAKR,cAAc1H,OAAS6G,IACvBoB,KAAAA,OAAO,UAAWqC,GAClB5C,KAAAA,cAAc3H,KAAKuK,MAOpCrG,EAAsBzG,UAAU+M,iBAAmB,SAAUjL,EAAML,GAC3D,KAAKgC,WAAW3B,IAEX2B,KAAAA,WAAW3B,GAAMS,KAAKd,IAGnCgF,EAAsBzG,UAAUgN,cAAgB,SAAUxC,GAClDyC,IAAAA,EAAKvC,EACLhF,EAAY,KAAKjC,WAAW+G,EAAM1I,MAClC4D,GAAAA,EACI,IACK,IAAA,IAAIwH,EAAc9F,EAAS1B,GAAYyH,EAAgBD,EAAY1F,QAAS2F,EAAc1F,KAAM0F,EAAgBD,EAAY1F,OAAQ,CACjI/F,IAAAA,EAAW0L,EAAcrM,MACxBuK,KAAAA,mBAAmBb,EAAO/I,IAGvC,MAAO2L,GAASH,EAAM,CAAE9H,MAAOiI,GACvB,QACA,IACID,IAAkBA,EAAc1F,OAASiD,EAAKwC,EAAYG,SAAS3C,EAAGzK,KAAKiN,GAE3E,QAAMD,GAAAA,EAAK,MAAMA,EAAI9H,OAG9B,OAAA,GAKXsB,EAAsBzG,UAAUsN,oBAAsB,SAAUxL,EAAML,GAC9D,KAAKgC,WAAW3B,KAEX2B,KAAAA,WAAW3B,GAAQ,KAAK2B,WAAW3B,GAAMyL,OAAO,SAAUC,GAAYA,OAAAA,IAAM/L,MAGzFgF,EAAsBzG,UAAUyK,OAAS,WAEhC,IADD3K,IAAAA,EAAO,GACF2N,EAAK,EAAGA,EAAKvK,UAAUV,OAAQiL,IACpC3N,EAAK2N,GAAMvK,UAAUuK,GAErB,KAAK9C,SAASpB,OAGdnJ,QAAQsN,IAAI/N,MAAMS,QAAS0H,EAAS,CAAC,QAAShI,KAGtD2G,EAAsBzG,UAAU2N,cAAgB,WACxCjD,IAAAA,EAAK,KAAKC,SAAUiD,EAAKlD,EAAGzB,4BAA6BA,OAAqC,IAAP2E,EAAgBjF,EAAQM,4BAA8B2E,EAAIC,EAAKnD,EAAG7B,qBAAsBA,OAA8B,IAAPgF,EAAgBlF,EAAQE,qBAAuBgF,EAAIC,EAAKpD,EAAG9B,qBAAsBA,OAA8B,IAAPkF,EAAgBnF,EAAQC,qBAAuBkF,EAC7VC,EAAQ,EASLA,OARH,KAAKlE,YAAc,IACnBkE,EACIlF,EAAuBC,KAAKkF,IAAI/E,EAA6B,KAAKY,YAAc,IACxEjB,IACRmF,EAAQnF,GAGX6B,KAAAA,OAAO,aAAcsD,GACnBA,GAEXtH,EAAsBzG,UAAUiO,MAAQ,WAChC/F,IAAAA,EAAQ,KACL,OAAA,IAAIgG,QAAQ,SAAUC,GACzBpD,WAAWoD,EAASjG,EAAMyF,oBAGlClH,EAAsBzG,UAAUoO,YAAc,SAAUC,GAChD,GAAuB,iBAAhBA,EACAH,OAAAA,QAAQC,QAAQE,GAEvB,GAAuB,mBAAhBA,EAA4B,CAC/B7E,IAAAA,EAAM6E,IACN,GAAe,iBAAR7E,EACA0E,OAAAA,QAAQC,QAAQ3E,GAEvB,GAAEA,EAAI8E,KACC9E,OAAAA,EAGT7G,MAAAA,MAAM,gBAEhB8D,EAAsBzG,UAAUyL,SAAW,WACnCvD,IAAAA,EAAQ,KACR,IAAA,KAAK6B,cAAiB,KAAKD,iBAA3B,CAGCC,KAAAA,cAAe,EAChBW,IAAAA,EAAK,KAAKC,SAAUiD,EAAKlD,EAAGvB,WAAYA,OAAoB,IAAPyE,EAAgBjF,EAAQQ,WAAayE,EAAIC,EAAKnD,EAAGxB,kBAAmBA,OAA2B,IAAP2E,EAAgBlF,EAAQO,kBAAoB2E,EAAIC,EAAKpD,EAAGlC,UAAWA,OAAmB,IAAPsF,EAAgBvF,IAAuBuF,EACnQ,GAAA,KAAKjE,aAAeV,EACfsB,KAAAA,OAAO,sBAAuB,KAAKZ,YAAa,KAAMV,OAD3D,CAOA,GAHCU,KAAAA,cACAY,KAAAA,OAAO,UAAW,KAAKZ,aACvB0E,KAAAA,oBACA9F,EAAYD,GACP7F,MAAAA,MAAM,qCAEXsL,KAAAA,QACAK,KAAK,WAAqBpG,OAAAA,EAAMkG,YAAYlG,EAAM0D,QAClD0C,KAAK,SAAU9E,GAEZtB,EAAM+B,eAGV/B,EAAMuC,OAAO,UAAW,CAAEjB,IAAKA,EAAKC,UAAWvB,EAAM2D,aACrD3D,EAAM+C,IAAM/C,EAAM2D,WACZ,IAAIrD,EAAUgB,EAAKtB,EAAM2D,YACzB,IAAIrD,EAAUgB,GACpBtB,EAAM+C,IAAIC,WAAahD,EAAM8B,YAC7B9B,EAAM6B,cAAe,EACrB7B,EAAMsG,gBACNtG,EAAM2C,gBAAkBE,WAAW,WAAqB7C,OAAAA,EAAMuG,kBAAqBvF,SAG3FzC,EAAsBzG,UAAUyO,eAAiB,WACxChE,KAAAA,OAAO,iBACPc,KAAAA,aAAa,IAAIvD,EAAWrF,MAAM,WAAY,QAEvD8D,EAAsBzG,UAAUwL,YAAc,SAAUpD,EAAMC,GAGtD,QAFS,IAATD,IAAmBA,EAAO,KACzBuD,KAAAA,iBACA,KAAKV,IAAN,CAGCsD,KAAAA,mBACD,IACKtD,KAAAA,IAAIrB,MAAMxB,EAAMC,GAChBqD,KAAAA,aAAa,IAAIvD,EAAWC,EAAMC,EAAQ,OAEnD,MAAOlD,OAIXsB,EAAsBzG,UAAUgL,YAAc,WACrCP,KAAAA,OAAO,eACPZ,KAAAA,YAAc,GAEvBpD,EAAsBzG,UAAUqL,mBAAqB,SAAUb,EAAO/I,GAC9D,gBAAiBA,EAEjBA,EAASiN,YAAYlE,GAIrB/I,EAAS+I,IAGjB/D,EAAsBzG,UAAUuO,iBAAmB,WAC1C,KAAKtD,MAGLR,KAAAA,OAAO,mBACPQ,KAAAA,IAAIqC,oBAAoB,OAAQ,KAAK/C,aACrCU,KAAAA,IAAIqC,oBAAoB,QAAS,KAAK5B,cACtCT,KAAAA,IAAIqC,oBAAoB,UAAW,KAAKhC,gBAExCL,KAAAA,IAAIqC,oBAAoB,QAAS,KAAK/B,gBAE/C9E,EAAsBzG,UAAUwO,cAAgB,WACvC,KAAKvD,MAGLR,KAAAA,OAAO,gBACPQ,KAAAA,IAAI8B,iBAAiB,OAAQ,KAAKxC,aAClCU,KAAAA,IAAI8B,iBAAiB,QAAS,KAAKrB,cACnCT,KAAAA,IAAI8B,iBAAiB,UAAW,KAAKzB,gBAErCL,KAAAA,IAAI8B,iBAAiB,QAAS,KAAKxB,gBAE5C9E,EAAsBzG,UAAU2L,eAAiB,WAC7Cf,aAAa,KAAKC,iBAClBD,aAAa,KAAKE,iBAEfrE,EA9cgC,GAid5BA,EAAAA,EAAAA,QAAAA,QAAAA;;AC1ef,aAhGA,IAAA,EAAA,EAAA,QAAA,WACA,EAAA,EAAA,QAAA,2BA+FA,SAAA,EAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,GA7FA,SAASkI,EAAWC,EAAmBC,EAAoBC,EAAkBC,GACnEC,IAAAA,EAAO,IAAIC,kBAAkB,CAC/BC,WAAY,CAAC,CAAEC,KAAM,mCAEnBC,EAAc,CAAEC,OAAO,GA0CtB,OAxCPP,EAAiBQ,UAAU,SAAuC,GAApCC,IAAAA,EAAAA,EAAAA,KAAMC,EAAAA,EAAAA,OAAQC,EAAAA,EAAAA,KAAMC,EAAAA,EAAAA,UAC1CD,EACkB,UAAdA,EAAK3N,MAAoByN,IAASR,GAClC3O,QAAQsN,IAAI,8BACZsB,EAAKW,qBAAqBF,GAAMnB,KAAK,WAE1BsB,OADPxP,QAAQsN,IAAI,sBACLkC,UAAUC,aAAaC,aAAaV,KAC5Cd,KAAK,SAAAyB,GAIGf,OAHP5O,QAAQsN,IAAI,kBACZqC,EAAOC,YAAY7E,QAAQ,SAAA8E,GAASjB,OAAAA,EAAKkB,SAASD,EAAOF,KACzD3P,QAAQsN,IAAI,sBACLsB,EAAKmB,iBACb7B,KAAK,SAAA8B,GAEGpB,OADP5O,QAAQsN,IAAI,6BACLsB,EAAKqB,oBAAoBD,KACjC9B,KAAK,WACJlO,QAAQsN,IAAI,oBACZoB,EAAiBzM,KAAK,CAClBkN,KAAMC,EACNA,OAAQD,EACRE,KAAMT,EAAKsB,sBAGE,WAAdb,EAAK3N,MAAqByN,IAASR,IAC1C3O,QAAQsN,IAAI,+BACZsB,EAAKW,qBAAqBF,IAEvBC,IACPtP,QAAQsN,IAAI,6BACZsB,EAAKuB,gBAAgBb,MAI7BV,EAAKwB,eAAiB,SAAA,GAAGd,IAAAA,EAAAA,EAAAA,UAAgBZ,OAAAA,EAAiBzM,KAAK,CAAEqN,UAAAA,KAEjEV,EAAKyB,QAAU,SAACjG,GACRqE,EAAmB6B,YACvB7B,EAAmB6B,UAAYlG,EAAMmG,QAAQ,KAG1C,SAAgBC,GACnBxQ,QAAQsN,IAAI,qBACZkC,UAAUC,aAAaC,aAAaV,GAC/Bd,KAAK,SAAAyB,GACF3P,QAAQsN,IAAI,iBACZqC,EAAOC,YAAY7E,QAAQ,SAAA8E,GAASjB,OAAAA,EAAKkB,SAASD,EAAOF,KACzDnB,EAAkB8B,UAAYX,IAC/BzB,KAAK,WAEDU,OADP5O,QAAQsN,IAAI,oBACLsB,EAAK6B,gBACbvC,KAAK,SAAAwC,GAEG9B,OADP5O,QAAQsN,IAAI,4BACLsB,EAAKqB,oBAAoBS,KACjCxC,KAAK,WAEGQ,OADP1O,QAAQsN,IAAI,kBACLoB,EAAiBzM,KAAK,CACzBkN,KAAMqB,EACNpB,OAAQT,EACRU,KAAMT,EAAKsB,sBAM3B,SAASS,IACCC,IAAAA,EAAS,IAAIvK,EAAJ,QAA0B,wBACnC3D,EAAU,IAAI/B,EAAJ,QAWT,OATPiQ,EAAOjE,iBAAiB,UAAW,SAAAzH,GAC3B,IACM2L,IAAAA,EAAMC,KAAKC,MAAM7L,EAAQwH,MAC/BhK,EAAQT,KAAK,UAAW4O,GAC1B,MAAOrJ,OAKN,CACH0H,UAAW,SAAC8B,GACRtO,EAAQ8C,GAAG,UAAW,SAAAqL,GAAOG,OAAAA,EAAGH,MAEpC5O,KAAM,SAAC4O,GACHD,EAAO5F,KAAK8F,KAAKG,UAAUJ,OAKvC,WACUK,IAAAA,EAAQC,OAAOC,SAASC,OAExBC,EAASC,SAASC,eAAe,UACjCC,EAASF,SAASC,eAAe,UACjCE,EAAOH,SAASC,eAAe,QAE/B9C,EAAmBiC,IAEnB9Q,EAAO0O,EAAW+C,EAAQG,EAAQ/C,EAAkBwC,GAE1DQ,EAAK/E,iBAAiB,SAAU,SAAAvC,GAC5BA,EAAMuH,iBACAlP,IAAAA,EAAOiP,EAAKE,SAAS,GAAGlR,MAC9Bb,EAAK4C,KAGT+M,UAAUC,aAAaC,aAAa,CAAET,OAAO,IACxCf,KAAK,SAAAyB,GACF2B,EAAOhB,UAAYX,IAnB/B","file":"src.e3f6b842.js","sourceRoot":"../src","sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\n\nvar Event = /** @class */ (function () {\r\n    function Event(type, target) {\r\n        this.target = target;\r\n        this.type = type;\r\n    }\r\n    return Event;\r\n}());\r\nvar ErrorEvent = /** @class */ (function (_super) {\r\n    __extends(ErrorEvent, _super);\r\n    function ErrorEvent(error, target) {\r\n        var _this = _super.call(this, 'error', target) || this;\r\n        _this.message = error.message;\r\n        _this.error = error;\r\n        return _this;\r\n    }\r\n    return ErrorEvent;\r\n}(Event));\r\nvar CloseEvent = /** @class */ (function (_super) {\r\n    __extends(CloseEvent, _super);\r\n    function CloseEvent(code, reason, target) {\r\n        if (code === void 0) { code = 1000; }\r\n        if (reason === void 0) { reason = ''; }\r\n        var _this = _super.call(this, 'close', target) || this;\r\n        _this.wasClean = true;\r\n        _this.code = code;\r\n        _this.reason = reason;\r\n        return _this;\r\n    }\r\n    return CloseEvent;\r\n}(Event));\n\n/*!\r\n * Reconnecting WebSocket\r\n * by Pedro Ladaria <pedro.ladaria@gmail.com>\r\n * https://github.com/pladaria/reconnecting-websocket\r\n * License MIT\r\n */\r\nvar getGlobalWebSocket = function () {\r\n    if (typeof WebSocket !== 'undefined') {\r\n        // @ts-ignore\r\n        return WebSocket;\r\n    }\r\n};\r\n/**\r\n * Returns true if given argument looks like a WebSocket class\r\n */\r\nvar isWebSocket = function (w) { return typeof w !== 'undefined' && !!w && w.CLOSING === 2; };\r\nvar DEFAULT = {\r\n    maxReconnectionDelay: 10000,\r\n    minReconnectionDelay: 1000 + Math.random() * 4000,\r\n    minUptime: 5000,\r\n    reconnectionDelayGrowFactor: 1.3,\r\n    connectionTimeout: 4000,\r\n    maxRetries: Infinity,\r\n    maxEnqueuedMessages: Infinity,\r\n    startClosed: false,\r\n    debug: false,\r\n};\r\nvar ReconnectingWebSocket = /** @class */ (function () {\r\n    function ReconnectingWebSocket(url, protocols, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        this._listeners = {\r\n            error: [],\r\n            message: [],\r\n            open: [],\r\n            close: [],\r\n        };\r\n        this._retryCount = -1;\r\n        this._shouldReconnect = true;\r\n        this._connectLock = false;\r\n        this._binaryType = 'blob';\r\n        this._closeCalled = false;\r\n        this._messageQueue = [];\r\n        /**\r\n         * An event listener to be called when the WebSocket connection's readyState changes to CLOSED\r\n         */\r\n        this.onclose = null;\r\n        /**\r\n         * An event listener to be called when an error occurs\r\n         */\r\n        this.onerror = null;\r\n        /**\r\n         * An event listener to be called when a message is received from the server\r\n         */\r\n        this.onmessage = null;\r\n        /**\r\n         * An event listener to be called when the WebSocket connection's readyState changes to OPEN;\r\n         * this indicates that the connection is ready to send and receive data\r\n         */\r\n        this.onopen = null;\r\n        this._handleOpen = function (event) {\r\n            _this._debug('open event');\r\n            var _a = _this._options.minUptime, minUptime = _a === void 0 ? DEFAULT.minUptime : _a;\r\n            clearTimeout(_this._connectTimeout);\r\n            _this._uptimeTimeout = setTimeout(function () { return _this._acceptOpen(); }, minUptime);\r\n            _this._ws.binaryType = _this._binaryType;\r\n            // send enqueued messages (messages sent before websocket open event)\r\n            _this._messageQueue.forEach(function (message) { return _this._ws.send(message); });\r\n            _this._messageQueue = [];\r\n            if (_this.onopen) {\r\n                _this.onopen(event);\r\n            }\r\n            _this._listeners.open.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._handleMessage = function (event) {\r\n            _this._debug('message event');\r\n            if (_this.onmessage) {\r\n                _this.onmessage(event);\r\n            }\r\n            _this._listeners.message.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._handleError = function (event) {\r\n            _this._debug('error event', event.message);\r\n            _this._disconnect(undefined, event.message === 'TIMEOUT' ? 'timeout' : undefined);\r\n            if (_this.onerror) {\r\n                _this.onerror(event);\r\n            }\r\n            _this._debug('exec error listeners');\r\n            _this._listeners.error.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n            _this._connect();\r\n        };\r\n        this._handleClose = function (event) {\r\n            _this._debug('close event');\r\n            _this._clearTimeouts();\r\n            if (_this._shouldReconnect) {\r\n                _this._connect();\r\n            }\r\n            if (_this.onclose) {\r\n                _this.onclose(event);\r\n            }\r\n            _this._listeners.close.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._url = url;\r\n        this._protocols = protocols;\r\n        this._options = options;\r\n        if (this._options.startClosed) {\r\n            this._shouldReconnect = false;\r\n        }\r\n        this._connect();\r\n    }\r\n    Object.defineProperty(ReconnectingWebSocket, \"CONNECTING\", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"OPEN\", {\r\n        get: function () {\r\n            return 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"CLOSING\", {\r\n        get: function () {\r\n            return 2;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"CLOSED\", {\r\n        get: function () {\r\n            return 3;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CONNECTING\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CONNECTING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"OPEN\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.OPEN;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CLOSING\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CLOSING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CLOSED\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CLOSED;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"binaryType\", {\r\n        get: function () {\r\n            return this._ws ? this._ws.binaryType : this._binaryType;\r\n        },\r\n        set: function (value) {\r\n            this._binaryType = value;\r\n            if (this._ws) {\r\n                this._ws.binaryType = value;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"retryCount\", {\r\n        /**\r\n         * Returns the number or connection retries\r\n         */\r\n        get: function () {\r\n            return Math.max(this._retryCount, 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"bufferedAmount\", {\r\n        /**\r\n         * The number of bytes of data that have been queued using calls to send() but not yet\r\n         * transmitted to the network. This value resets to zero once all queued data has been sent.\r\n         * This value does not reset to zero when the connection is closed; if you keep calling send(),\r\n         * this will continue to climb. Read only\r\n         */\r\n        get: function () {\r\n            var bytes = this._messageQueue.reduce(function (acc, message) {\r\n                if (typeof message === 'string') {\r\n                    acc += message.length; // not byte size\r\n                }\r\n                else if (message instanceof Blob) {\r\n                    acc += message.size;\r\n                }\r\n                else {\r\n                    acc += message.byteLength;\r\n                }\r\n                return acc;\r\n            }, 0);\r\n            return bytes + (this._ws ? this._ws.bufferedAmount : 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"extensions\", {\r\n        /**\r\n         * The extensions selected by the server. This is currently only the empty string or a list of\r\n         * extensions as negotiated by the connection\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.extensions : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"protocol\", {\r\n        /**\r\n         * A string indicating the name of the sub-protocol the server selected;\r\n         * this will be one of the strings specified in the protocols parameter when creating the\r\n         * WebSocket object\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.protocol : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"readyState\", {\r\n        /**\r\n         * The current state of the connection; this is one of the Ready state constants\r\n         */\r\n        get: function () {\r\n            if (this._ws) {\r\n                return this._ws.readyState;\r\n            }\r\n            return this._options.startClosed\r\n                ? ReconnectingWebSocket.CLOSED\r\n                : ReconnectingWebSocket.CONNECTING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"url\", {\r\n        /**\r\n         * The URL as resolved by the constructor\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.url : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Closes the WebSocket connection or connection attempt, if any. If the connection is already\r\n     * CLOSED, this method does nothing\r\n     */\r\n    ReconnectingWebSocket.prototype.close = function (code, reason) {\r\n        if (code === void 0) { code = 1000; }\r\n        this._closeCalled = true;\r\n        this._shouldReconnect = false;\r\n        this._clearTimeouts();\r\n        if (!this._ws) {\r\n            this._debug('close enqueued: no ws instance');\r\n            return;\r\n        }\r\n        if (this._ws.readyState === this.CLOSED) {\r\n            this._debug('close: already closed');\r\n            return;\r\n        }\r\n        this._ws.close(code, reason);\r\n    };\r\n    /**\r\n     * Closes the WebSocket connection or connection attempt and connects again.\r\n     * Resets retry counter;\r\n     */\r\n    ReconnectingWebSocket.prototype.reconnect = function (code, reason) {\r\n        this._shouldReconnect = true;\r\n        this._closeCalled = false;\r\n        this._retryCount = -1;\r\n        if (!this._ws || this._ws.readyState === this.CLOSED) {\r\n            this._connect();\r\n        }\r\n        else {\r\n            this._disconnect(code, reason);\r\n            this._connect();\r\n        }\r\n    };\r\n    /**\r\n     * Enqueue specified data to be transmitted to the server over the WebSocket connection\r\n     */\r\n    ReconnectingWebSocket.prototype.send = function (data) {\r\n        if (this._ws && this._ws.readyState === this.OPEN) {\r\n            this._debug('send', data);\r\n            this._ws.send(data);\r\n        }\r\n        else {\r\n            var _a = this._options.maxEnqueuedMessages, maxEnqueuedMessages = _a === void 0 ? DEFAULT.maxEnqueuedMessages : _a;\r\n            if (this._messageQueue.length < maxEnqueuedMessages) {\r\n                this._debug('enqueue', data);\r\n                this._messageQueue.push(data);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Register an event handler of a specific event type\r\n     */\r\n    ReconnectingWebSocket.prototype.addEventListener = function (type, listener) {\r\n        if (this._listeners[type]) {\r\n            // @ts-ignore\r\n            this._listeners[type].push(listener);\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype.dispatchEvent = function (event) {\r\n        var e_1, _a;\r\n        var listeners = this._listeners[event.type];\r\n        if (listeners) {\r\n            try {\r\n                for (var listeners_1 = __values(listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {\r\n                    var listener = listeners_1_1.value;\r\n                    this._callEventListener(event, listener);\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Removes an event listener\r\n     */\r\n    ReconnectingWebSocket.prototype.removeEventListener = function (type, listener) {\r\n        if (this._listeners[type]) {\r\n            // @ts-ignore\r\n            this._listeners[type] = this._listeners[type].filter(function (l) { return l !== listener; });\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._debug = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (this._options.debug) {\r\n            // not using spread because compiled version uses Symbols\r\n            // tslint:disable-next-line\r\n            console.log.apply(console, __spread(['RWS>'], args));\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._getNextDelay = function () {\r\n        var _a = this._options, _b = _a.reconnectionDelayGrowFactor, reconnectionDelayGrowFactor = _b === void 0 ? DEFAULT.reconnectionDelayGrowFactor : _b, _c = _a.minReconnectionDelay, minReconnectionDelay = _c === void 0 ? DEFAULT.minReconnectionDelay : _c, _d = _a.maxReconnectionDelay, maxReconnectionDelay = _d === void 0 ? DEFAULT.maxReconnectionDelay : _d;\r\n        var delay = 0;\r\n        if (this._retryCount > 0) {\r\n            delay =\r\n                minReconnectionDelay * Math.pow(reconnectionDelayGrowFactor, this._retryCount - 1);\r\n            if (delay > maxReconnectionDelay) {\r\n                delay = maxReconnectionDelay;\r\n            }\r\n        }\r\n        this._debug('next delay', delay);\r\n        return delay;\r\n    };\r\n    ReconnectingWebSocket.prototype._wait = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            setTimeout(resolve, _this._getNextDelay());\r\n        });\r\n    };\r\n    ReconnectingWebSocket.prototype._getNextUrl = function (urlProvider) {\r\n        if (typeof urlProvider === 'string') {\r\n            return Promise.resolve(urlProvider);\r\n        }\r\n        if (typeof urlProvider === 'function') {\r\n            var url = urlProvider();\r\n            if (typeof url === 'string') {\r\n                return Promise.resolve(url);\r\n            }\r\n            if (!!url.then) {\r\n                return url;\r\n            }\r\n        }\r\n        throw Error('Invalid URL');\r\n    };\r\n    ReconnectingWebSocket.prototype._connect = function () {\r\n        var _this = this;\r\n        if (this._connectLock || !this._shouldReconnect) {\r\n            return;\r\n        }\r\n        this._connectLock = true;\r\n        var _a = this._options, _b = _a.maxRetries, maxRetries = _b === void 0 ? DEFAULT.maxRetries : _b, _c = _a.connectionTimeout, connectionTimeout = _c === void 0 ? DEFAULT.connectionTimeout : _c, _d = _a.WebSocket, WebSocket = _d === void 0 ? getGlobalWebSocket() : _d;\r\n        if (this._retryCount >= maxRetries) {\r\n            this._debug('max retries reached', this._retryCount, '>=', maxRetries);\r\n            return;\r\n        }\r\n        this._retryCount++;\r\n        this._debug('connect', this._retryCount);\r\n        this._removeListeners();\r\n        if (!isWebSocket(WebSocket)) {\r\n            throw Error('No valid WebSocket class provided');\r\n        }\r\n        this._wait()\r\n            .then(function () { return _this._getNextUrl(_this._url); })\r\n            .then(function (url) {\r\n            // close could be called before creating the ws\r\n            if (_this._closeCalled) {\r\n                return;\r\n            }\r\n            _this._debug('connect', { url: url, protocols: _this._protocols });\r\n            _this._ws = _this._protocols\r\n                ? new WebSocket(url, _this._protocols)\r\n                : new WebSocket(url);\r\n            _this._ws.binaryType = _this._binaryType;\r\n            _this._connectLock = false;\r\n            _this._addListeners();\r\n            _this._connectTimeout = setTimeout(function () { return _this._handleTimeout(); }, connectionTimeout);\r\n        });\r\n    };\r\n    ReconnectingWebSocket.prototype._handleTimeout = function () {\r\n        this._debug('timeout event');\r\n        this._handleError(new ErrorEvent(Error('TIMEOUT'), this));\r\n    };\r\n    ReconnectingWebSocket.prototype._disconnect = function (code, reason) {\r\n        if (code === void 0) { code = 1000; }\r\n        this._clearTimeouts();\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._removeListeners();\r\n        try {\r\n            this._ws.close(code, reason);\r\n            this._handleClose(new CloseEvent(code, reason, this));\r\n        }\r\n        catch (error) {\r\n            // ignore\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._acceptOpen = function () {\r\n        this._debug('accept open');\r\n        this._retryCount = 0;\r\n    };\r\n    ReconnectingWebSocket.prototype._callEventListener = function (event, listener) {\r\n        if ('handleEvent' in listener) {\r\n            // @ts-ignore\r\n            listener.handleEvent(event);\r\n        }\r\n        else {\r\n            // @ts-ignore\r\n            listener(event);\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._removeListeners = function () {\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._debug('removeListeners');\r\n        this._ws.removeEventListener('open', this._handleOpen);\r\n        this._ws.removeEventListener('close', this._handleClose);\r\n        this._ws.removeEventListener('message', this._handleMessage);\r\n        // @ts-ignore\r\n        this._ws.removeEventListener('error', this._handleError);\r\n    };\r\n    ReconnectingWebSocket.prototype._addListeners = function () {\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._debug('addListeners');\r\n        this._ws.addEventListener('open', this._handleOpen);\r\n        this._ws.addEventListener('close', this._handleClose);\r\n        this._ws.addEventListener('message', this._handleMessage);\r\n        // @ts-ignore\r\n        this._ws.addEventListener('error', this._handleError);\r\n    };\r\n    ReconnectingWebSocket.prototype._clearTimeouts = function () {\r\n        clearTimeout(this._connectTimeout);\r\n        clearTimeout(this._uptimeTimeout);\r\n    };\r\n    return ReconnectingWebSocket;\r\n}());\n\nexport default ReconnectingWebSocket;\n","import EventEmitter from \"events\"\nimport ReconnectingWebSocket from \"reconnecting-websocket\";\n\nfunction createPeer(localVideoElement, remoteVideoElement, signalingChannel, localCallId) {\n    const peer = new RTCPeerConnection({\n        iceServers: [{ urls: 'stun:stun.l.google.com:19302' },],\n    })\n    const constraints = { video: true }\n\n    signalingChannel.subscribe(({ toId, fromId, desc, candidate }) => {\n        if (desc) {\n            if (desc.type === 'offer' && toId === localCallId) {\n                console.log('offer:setRemoteDescription')\n                peer.setRemoteDescription(desc).then(() => {\n                    console.log('offer:getUserMedia')\n                    return navigator.mediaDevices.getUserMedia(constraints)\n                }).then(stream => {\n                    console.log('offer:addTrack')\n                    stream.getTracks().forEach(track => peer.addTrack(track, stream))\n                    console.log('offer:createAnswer')\n                    return peer.createAnswer()\n                }).then(answer => {\n                    console.log('offer:setLocalDescription')\n                    return peer.setLocalDescription(answer)\n                }).then(() => {\n                    console.log('offer:sendAnswer')\n                    signalingChannel.emit({\n                        toId: fromId,\n                        fromId: toId,\n                        desc: peer.localDescription\n                    })\n                })\n            } else if (desc.type === 'answer' && toId === localCallId) {\n                console.log('answer:setRemoteDescription')\n                peer.setRemoteDescription(desc)\n            }\n        } else if (candidate) {\n            console.log('candidate:addIceCandidate')\n            peer.addIceCandidate(candidate)\n        }\n    })\n\n    peer.onicecandidate = ({ candidate }) => signalingChannel.emit({ candidate });\n\n    peer.ontrack = (event) => {\n        if (remoteVideoElement.srcObject) return\n        remoteVideoElement.srcObject = event.streams[0]\n    }\n\n    return function callTo(remoteCallId) {\n        console.log('call:getUserMedia')\n        navigator.mediaDevices.getUserMedia(constraints)\n            .then(stream => {\n                console.log('call:addTrack')\n                stream.getTracks().forEach(track => peer.addTrack(track, stream))\n                localVideoElement.srcObject = stream\n            }).then(() => {\n            console.log('call:createOffer')\n            return peer.createOffer()\n        }).then(offer => {\n            console.log('call:setLocalDescription')\n            return peer.setLocalDescription(offer)\n        }).then(() => {\n            console.log('call:sendOffer')\n            return signalingChannel.emit({\n                toId: remoteCallId,\n                fromId: localCallId,\n                desc: peer.localDescription\n            })\n        });\n    }\n}\n\nfunction wsSignalingChannel() {\n    const socket = new ReconnectingWebSocket(\"wss://wss.homefs.biz\")\n    const emitter = new EventEmitter()\n\n    socket.addEventListener(\"message\", message => {\n        try {\n            const msg = JSON.parse(message.data)\n            emitter.emit('message', msg)\n        } catch (e) {\n            /* NOP */\n        }\n    })\n\n    return {\n        subscribe: (cb) => {\n            emitter.on('message', msg => cb(msg))\n        },\n        emit: (msg) => {\n            socket.send(JSON.stringify(msg))\n        }\n    }\n}\n\n(function main() {\n    const ownId = window.location.search\n\n    const video1 = document.getElementById(\"video1\")\n    const video2 = document.getElementById(\"video2\")\n    const form = document.getElementById(\"form\")\n\n    const signalingChannel = wsSignalingChannel()\n\n    const call = createPeer(video1, video2, signalingChannel, ownId)\n\n    form.addEventListener(\"submit\", event => {\n        event.preventDefault()\n        const name = form.elements[0].value\n        call(name)\n    })\n\n    navigator.mediaDevices.getUserMedia({ video: true })\n        .then(stream => {\n            video1.srcObject = stream\n        })\n})()\n\n"]}